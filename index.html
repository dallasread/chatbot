<!DOCTYPE html>
<html>
<head>
    <title>Chatbot</title>

    <link rel="stylesheet" type="text/css" href="./assets/application.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <!-- <link href="assets/imgs/app-logo.png" rel="apple-touch-icon"> -->

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
</head>
<body style="background: #fafafa;">
    <div id="container" style="background: #fff; max-width: 640px; margin: 0 auto; "></div>
    <script src="./assets/application.min.js"></script>
    <script>
        var getInfo = {
                text: 'OK, we would like to put you in touch with some rentals. What is the best way to get a hold of you?',
                input: {
                    choices: [
                        {
                            text: 'Email',
                            response: {
                                text: 'What is your email address?',
                                input: {
                                    type: 'email',
                                    name: 'email',
                                    placeholder: 'you@email.com'
                                }
                            }
                        },
                        {
                            text: 'Cell',
                            response: {
                                text: 'What is your phone number?',
                                input: {
                                    type: 'tel',
                                    name: 'mobile',
                                    placeholder: '902-333-4444'
                                }
                            }
                        }
                    ]
                }
            },
            bot = new window.Chatbot({
                agent: {
                    avatar: 'https://s.gravatar.com/avatar/e497bb225c12537ce0865d854484faca?s=80'
                },
                onComplete: function onComplete() {
                    var _ = this;
                    alert(JSON.stringify(_.get('user')));
                    _.addMessage({ text: 'Thanks ‚Äì we will respond ASAP!' });
                },
                schema: {
                    text: 'Hi! I\'m here to help you with your housing needs... Are you looking to:',
                    input: {
                        name: 'type',
                        choices: [
                            {
                                text: 'Buy',
                                response: {
                                    text: 'Great! I can definitely help.',
                                    delayed: {
                                        text: 'Where are you looking?',
                                        input: {
                                            type: 'city',
                                            name: 'city',
                                            placeholder: 'Halifax, NS'
                                        },
                                        response: {
                                            text: 'What is your budget?',
                                            input: {
                                                name: 'budget',
                                                choices: [
                                                    {
                                                        text: '$500',
                                                        response: getInfo
                                                    },
                                                    {
                                                        text: '$1,000',
                                                        response: getInfo
                                                    },
                                                    {
                                                        text: '$1,500',
                                                        response: getInfo
                                                    }
                                                ]
                                            }
                                        }
                                    }
                                }
                            },
                            {
                                text: 'Rent',
                                response: {
                                    text: 'üëç We will have to complete this part of the config file!'
                                }
                            }
                        ]
                    }
                }
            });

        document.getElementById('container').appendChild(bot.element);
    </script>
</body>
</html>
